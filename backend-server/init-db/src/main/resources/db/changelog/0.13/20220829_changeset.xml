<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
	  http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd">

    <changeSet id="V0.13-20220829-001" author="吴奕涛" labels="unit">
        <comment>创建组织架构-角色表</comment>
        <sql>
            CREATE TABLE `vika_unit_role`(
                `id`         bigint                                               NOT NULL COMMENT '主键',
                `space_id`   varchar(50)                                          NOT NULL COMMENT '空间ID(关联#vika_space#space_id)',
                `role_name`  varchar(100)                                         NOT NULL COMMENT '角色名称',
                `sequence`   tinyint unsigned        DEFAULT '1'                  NOT NULL COMMENT '角色序列号(默认从1开始)',
                `is_deleted` tinyint(1) unsigned     DEFAULT '0'                  NOT NULL COMMENT '删除标记(0:否,1:是)',
                `create_by`  bigint                                               NOT NULL COMMENT '创建人',
                `update_by`  bigint                                               NULL COMMENT '更新人',
                `create_at`  timestamp               DEFAULT CURRENT_TIMESTAMP    NOT NULL COMMENT '创建时间',
                `update_at`  timestamp               DEFAULT CURRENT_TIMESTAMP    NOT NULL ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
                PRIMARY KEY (`id`) using BTREE,
                KEY `k_space_id` (`space_id`) USING BTREE
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='组织单元-角色表';
        </sql>
    </changeSet>

    <changeSet id="V0.13-20220829-002" author="吴奕涛" labels="unit">
        <comment>创建组织架构角色成员关联表</comment>
        <sql>
            CREATE TABLE `vika_unit_role_member`(
                `id`          bigint                                             NOT NULL COMMENT '主键',
                `role_id`     bigint                                             NOT NULL COMMENT '角色ID(关联#vika_unit_role#id)',
                `unit_ref_id` bigint                                             NOT NULL COMMENT '成员/部门ID(关联#vika_unit_team#id | #vika_unit_member#id)',
                `unit_type`   tinyint(1) unsigned                                NOT NULL COMMENT '1: 部门；3: 成员',
                `created_at`  timestamp             DEFAULT CURRENT_TIMESTAMP    NOT NULL COMMENT '创建时间',
                PRIMARY KEY (`id`) USING BTREE,
                KEY `k_role_id` (`role_id`) USING BTREE,
                KEY `k_unit_ref_id` (`unit_ref_id`) USING BTREE
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='组织架构-角色成员关联表';
        </sql>
    </changeSet>

    <changeSet id="V0.13-20220829-003" author="吴奕涛" labels="unit">
        <comment>新增空间角色管理资源数据</comment>
        <sqlFile path="db/changelog/0.13/20220829_changeset_003.sql"/>
    </changeSet>

</databaseChangeLog>