.build_widget_stage_script:
  script:
    - echo "run widget-stage build"
    - ls -a
    - echo $CI_COMMIT_REF_NAME
    - yarn build:widget-stage

# 部署widget-stage端脚本
.deploy_widget_stage_script:
  script:
    - echo "run widget-stage deploy"
    - echo $CI_COMMIT_SHA
    - echo $WIDGET_STAGE_ENV
    - ls -a
    # 上传之前,删除，防止代码泄露
    - rm packages/widget-stage/build/static/**/*.map
    # 上传S3
    - aws s3 cp packages/widget-stage/build s3://commpents.vika.ltd/widget-stage/$WIDGET_STAGE_ENV --recursive --include "*"

# 部署widget-stage端脚本
.release_deploy_widget_stage_script:
  script:
    - echo "run widget-stage deploy"
    - echo $CI_COMMIT_SHA
    - echo $WIDGET_STAGE_ENV
    - ls -a
    # 上传之前,删除，防止代码泄露
    - rm packages/widget-stage/build/static/**/*.map
    # 上传S3
    - aws s3 cp packages/widget-stage/build s3://commpents.vika.cn/widget-stage --recursive --include "*"
